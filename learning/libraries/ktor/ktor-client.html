<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-learning docs-doc-id-libraries/ktor/ktor-client">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-91G2XYQTXS"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-91G2XYQTXS",{})</script><title data-rh="true">ktor-client | Kotlin Multiplatform Mobile</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kmm.icerock.dev/learning/libraries/ktor/ktor-client"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-learning-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-learning-current"><meta data-rh="true" property="og:title" content="ktor-client | Kotlin Multiplatform Mobile"><meta data-rh="true" name="description" content="Библиотека работы с сетью. Основная документация"><meta data-rh="true" property="og:description" content="Библиотека работы с сетью. Основная документация"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kmm.icerock.dev/learning/libraries/ktor/ktor-client"><link data-rh="true" rel="alternate" href="https://kmm.icerock.dev/learning/libraries/ktor/ktor-client" hreflang="en"><link data-rh="true" rel="alternate" href="https://kmm.icerock.dev/learning/libraries/ktor/ktor-client" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.893f3d2c.css">
<link rel="preload" href="/assets/js/runtime~main.2fb500ba.js" as="script">
<link rel="preload" href="/assets/js/main.3aac4c1b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Home</b></a><a class="navbar__item navbar__link" href="/onboarding/intro">Onboarding</a><a class="navbar__item navbar__link navbar__link--active" href="/learning/intro">Knowledge Base</a><a class="navbar__item navbar__link" href="/university/intro">University</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/icerockdev/kmm.icerock.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learning/intro">О разделе</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/learning/code-style/general-rules">CodeStyle</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/learning/gradle/intro-gradle">Gradle</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/learning/android/study-materials">Android</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/learning/ios/study-materials">iOS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/learning/kotlin/study-materials">Kotlin</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/learning/compose-multiplatform/links">Compose Multiplatform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/learning/kotlin-multiplatform/how-to-start">Kotlin Multiplatform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/learning/kotlin-native/summary">Kotlin/Native</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/learning/libraries/kotlinx/coroutines">Библиотеки</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/learning/libraries/kotlinx/coroutines">KotlinX</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/learning/libraries/ktor/ktor-client">Ktor</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/learning/libraries/ktor/ktor-client">ktor-client</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/learning/libraries/moko">MOKO</a><button aria-label="Toggle the collapsible sidebar category &#x27;MOKO&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/learning/libraries/publication">Публикация</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/learning/problem-solving/gradle-daemon-crash">Решения проблем</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learning/memory_management">Работа с памятью</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learning/concurrency">Многопоточность</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learning/state">Единый стейт экрана</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learning/socket">Socket</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learning/links">Ссылки</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learning/code">Примеры кода</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learning/movement_workspace_dir">Перенос dev tools на другой диск</a></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Библиотеки</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Ktor</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">ktor-client</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ktor-client</h1><p>Библиотека работы с сетью. Основная документация
доступна <a href="https://ktor.io/docs/getting-started-ktor-client.html" target="_blank" rel="noopener noreferrer">на сайте</a>.<br>
<!-- -->В проектах IceRock библиотека используется в паре
с <a href="https://github.com/icerockdev/moko-network" target="_blank" rel="noopener noreferrer">moko-network</a>, которая генерирует из OpenAPI
спецификации весь сетевой код и сетевые сущности (с сериализацией
через <a href="https://github.com/Kotlin/kotlinx.serialization" target="_blank" rel="noopener noreferrer">kotlinx.serialization</a>).</p><p>Начиная с ktor 1.4.0 на iOS библиотека требует использования native-mt версии корутин (внутри ktor
реализована полноценная многопоточность с обработкой всего pipeline на фоновом потоке).</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="особенности-инициализации">Особенности инициализации<a class="hash-link" href="#особенности-инициализации" title="Direct link to heading">​</a></h2><p>Начиная с ktor 1.4.1 все блоки настроек features замораживаются на iOS. Поэтому требуется подходить
к инициализации HttpClient&#x27;а аккуратно.</p><p>Важно не подавать в лямбды настроек ничего, что нельзя заморозить. Например передавать <code>this</code>
объекта (то есть нельзя работать с полями класса, надо сохранить их в локальные переменные в стеке,
а потом уже эти переменные использовать в лямбде).</p><p>Например:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// обертка над https://github.com/russhwolf/multiplatform-settings с свойствами для доступа к хранилищу</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">private val keyValueStorage: KeyValueStorage by lazy {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    KeyValueStorage(settings)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// парсер json от https://github.com/Kotlin/kotlinx.serialization</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">private val json: Json by lazy {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Json {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // чтобы если в api появятся новые ключи то у нас приложение их будет игнорировать, а не крашиться</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ignoreUnknownKeys = true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">private val httpClient: HttpClient by lazy {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Ссылки на инстансы зависимостей для фичей клиента, чтобы не замораживать для KN объект</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // SharedFactory через ссылки на this (httpClient в некоторый момент может заморозиться -</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // что приведет к заморозке фичей и всех зависимостей фичей).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // https://kotlinlang.org/docs/native-immutability.html</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // https://kotlinlang.org/docs/native-concurrency.html</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val json = this.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val keyValueStorage = this.keyValueStorage</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    HttpClient {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // включаем ExceptionFeature из moko-network для обработки ошибок</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        install(ExceptionFeature) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exceptionFactory = HttpExceptionFactory(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                defaultParser = ErrorExceptionParser(json),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                customParsers = mapOf(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    HttpStatusCode.UnprocessableEntity.value to ValidationExceptionParser(json)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // выключаем стандартный BadResponseStatus чтобы работала ExceptionFeature</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        expectSuccess = false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // включаем логирование запросов</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        install(Logging) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            logger = Logger.DEFAULT // TODO сменить на Napier с шарингом между потоками</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            level = LogLevel.INFO</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="получение-httpresponse">Получение HttpResponse<a class="hash-link" href="#получение-httpresponse" title="Direct link to heading">​</a></h2><p>При выполнении запроса мы можем указать тип ответа, который мы хотим получить. И ktor-client
автоматически
постарается <a href="https://ktor.io/docs/response.html" target="_blank" rel="noopener noreferrer">привести полученный от сервера ответ в нужный нам тип</a>
. За это отвечает <code>responsePipeline</code>, который обрабатывается при выполнении <code>receive</code> у
класса <code>HttpResponse</code>. На данном пайплайне находится и логика <code>ExceptionFeature</code> и
логика <code>JsonFeature</code> и многие другие.</p><p>В случае если хочется выполнить запрос с полностью кастомной логикой обработки ответа, которая не
будет проходить через <code>responsePipeline</code>, можно сделать так:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">val response = httpClient.get&lt;HttpResponse&gt;(requestUrl)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if (response.status.isSuccess()) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // success handle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">} else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val statusCode: HttpStatusCode = response.status</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // read text without call responsePipeline in ktor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val body: String = String(response.content.toByteArray())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>В примере мы не обращаемся к <code>response.receive</code> чтобы не происходила обработка <code>responsePipeline</code>.
Вместо этого мы работаем напрямую с <code>response.content</code>, который является чистым видом пришедших от
сервера данных.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="добавление-логики-в-обработку-каждого-запросаответа">Добавление логики в обработку каждого запроса/ответа<a class="hash-link" href="#добавление-логики-в-обработку-каждого-запросаответа" title="Direct link to heading">​</a></h2><p>Для этого используются Ktor Features, которые позволяют поставить дополнительные блоки на pipeline.
Примеры использования стандартных фич можно посмотреть в
статье <a href="https://yusufabd.medium.com/kotlin-multiplatform-mobile-intercepting-network-request-and-response-6805a79b4699" target="_blank" rel="noopener noreferrer">Kotlin Multiplatform Mobile: Intercepting Network Request and Response</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="отправка-файлов">Отправка файлов<a class="hash-link" href="#отправка-файлов" title="Direct link to heading">​</a></h2><p>Для отправки файлов используются составные запросы со следующими типами содержимого:</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="multipartform-data">multipart/form-data<a class="hash-link" href="#multipartform-data" title="Direct link to heading">​</a></h3><p><a href="https://ru.wikipedia.org/wiki/Multipart/form-data" target="_blank" rel="noopener noreferrer">ссылка на wiki</a></p><p>Данный тип является наиболее распространенным и позволяет отправлять сразу несколько файлов в запросе. Каждый из передаваемых файлов будет описан в теле запроса с основной информацией по нему. Пример <em>body</em> такого запроса:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">POST /form.html HTTP/1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Host: server.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Referer: http://server.com/form.html</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User-Agent: Mozilla</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Type: multipart/form-data; boundary=-------------573cf973d5228</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Length: 288</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Connection: keep-alive</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Keep-Alive: 300</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(пустая строка)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(отсутствующая преамбула)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">---------------573cf973d5228</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Disposition: form-data; name=&quot;field&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">text</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">---------------573cf973d5228</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;sample.txt&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Type: text/plain</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Content file</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">---------------573cf973d5228--</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Как видно из <em>body</em>, у нас есть несколько параметров: <code>field</code> и <code>file</code>. Первый параметр представляет собой строковую константу, второй - файл.</p><p>При использовании данного подхода в ktor предусмотрен механизм создания <code>formData</code>. Здесь можно также разделить использование на несколько подходов:</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="передача-файла-как-bytearray">Передача файла как ByteArray<a class="hash-link" href="#передача-файла-как-bytearray" title="Direct link to heading">​</a></h3><p>Данный подход хорошо описан в документации ktor (<a href="https://ktor.io/docs/request.html#upload_file" target="_blank" rel="noopener noreferrer">ссылка на документацию</a>).
Важной деталью в данной ссылке является добавление заголовка с файлом, который представлен в виде <code>byteArray</code>:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">append(&quot;image&quot;, File(&quot;ktor_logo.png&quot;).readBytes(), Headers.build {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    append(HttpHeaders.ContentType, &quot;image/png&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    append(HttpHeaders.ContentDisposition, &quot;filename=ktor_logo.png&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="передача-файла-как-input">Передача файла как Input<a class="hash-link" href="#передача-файла-как-input" title="Direct link to heading">​</a></h3><p>Этот подход подразумевает использование <em>kotlinx-io</em> <code>Input</code> (<a href="https://ktor.kotlincn.net/kotlinx/io/io/input-output.html" target="_blank" rel="noopener noreferrer">ссылка на класс</a>). В таком случае используется другой подход формирования <code>formData</code>:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">val data: List&lt;PartData&gt; = formData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    appendInput(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        key = &quot;yourKey&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        block = { input },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        headers = Headers.build {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            append(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                HttpHeaders.ContentType,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ContentType.Application.OctetStream.toString()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            append(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                HttpHeaders.ContentDisposition, ContentDisposition.File</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    .withParameter(ContentDisposition.Parameters.FileName, fileName)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    .toString()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>В примере представлен вариант добавления <code>headers</code>, по умолчанию <em>Empty</em>. Здесь можно конфигурировать хедеры под ваши нужды.</p><p>Касаемо использования formData, существует несколько подходов в формировании <em>ktor</em> HTTP клиента:</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="передача-файла-как-input-в-common-коде">Передача файла как Input в common коде<a class="hash-link" href="#передача-файла-как-input-в-common-коде" title="Direct link to heading">​</a></h3><p>Чтобы реализовать потоковую передачу файла в общем коде, используя ktor, необходимо получить объект <a href="https://api.ktor.io/older/1.6.8/ktor-io/io.ktor.utils.io.core/-input/index.html" target="_blank" rel="noopener noreferrer">Input</a> на основе файла. Сделать это в общем коде можно используя expect/actual функции:  </p><p><strong><em>commonMain:</em></strong></p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">expect fun inputByFilepath(filePath: String): Input</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong><em>androidMain:</em></strong></p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">actual fun inputByFilepath(filePath: String): Input{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val file = File(filePath)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val inputStream = file.inputStream()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return inputStream.asInput()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong><em>iosMain:</em></strong></p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">actual fun inputByFilepath(filePath: String): Input {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val fileHandle = NSFileHandle.fileHandleForReadingAtPath(path = filePath)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return Input(fileHandle!!.fileDescriptor)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="submitformwithbinarydata">submitFormWithBinaryData<a class="hash-link" href="#submitformwithbinarydata" title="Direct link to heading">​</a></h3><p>Для использования этого метода необходимо заранее сформировать <code>formData</code>. Код с таким методом выглядит следующим образом:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">val result = httpClient.submitFormWithBinaryData&lt;String&gt;(formData = data) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Здесь <code>data</code> - сформированная <em>multipart formData</em>. В теле httpClient возможны настройки самого клиента, в том числе url, хедеры, тип метода (<strong>важный поинт - multipart/form-data запросы должны быть только POST запросами!</strong>)</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="multipartformdatacontent">MultiPartFormDataContent<a class="hash-link" href="#multipartformdatacontent" title="Direct link to heading">​</a></h3><p>Здесь для ktor клиента в качестве <em>body</em> присваивается <code>MultiPartFormDataContent()</code>, параметром является список <code>PartData</code>, формируемый <code>formData</code>. Пример кода:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">val result = httpClient.post&lt;Unit&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    body = MultiPartFormDataContent(parts = data)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="applicationoctet-stream">application/octet-stream<a class="hash-link" href="#applicationoctet-stream" title="Direct link to heading">​</a></h3><p>Данный подход используется довольно редко, но все же используется. Для данного типа запроса нет возможности передать несколько параметров или файлов, можно отправлять файл, притом только один. Для реализации подхода необходимо создать класс, унаследованный от <code>WriteChannelContent</code> (<a href="https://www.mvndoc.com/c/io.ktor/ktor-http-iosarm64/io/ktor/http/content/OutgoingContent.WriteChannelContent.html" target="_blank" rel="noopener noreferrer">ссылка на класс</a>). Пример кода:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">private class PhotoChannelContentStream(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private val photo: ByteArray</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">) : OutgoingContent.WriteChannelContent() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    override suspend fun writeTo(channel: ByteWriteChannel) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        channel.writeFully(photo, 0, photo.size)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    override val contentType: ContentType = ContentType.Application.OctetStream</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    override val contentLength: Long = photo.size.toLong()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>При реализации такого подхода возможно только использование <code>MultiPartFormDataContent</code> в качестве <em>body</em>.
Пример использования <em>ktor client</em>:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">httpClient.put&lt;String&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    body = PhotoChannelContentStream(image)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Про разницу типов содержимого более подробно можно прочитать по этой <a href="https://russianblogs.com/article/2287567080/" target="_blank" rel="noopener noreferrer">ссылке</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="загрузка-файлов">Загрузка файлов<a class="hash-link" href="#загрузка-файлов" title="Direct link to heading">​</a></h2><p>Ознакомьтесь с <a href="https://ktor.io/docs/response.html#streaming" target="_blank" rel="noopener noreferrer">документацией</a> Ktor и <a href="https://blog.kotlin-academy.com/download-files-with-ktor-and-coroutines-e96b1cc8b657" target="_blank" rel="noopener noreferrer">статьей</a> про загрузку файлов, используя Ktor.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="загрузка-файлов-в-кеш">Загрузка файлов в кеш<a class="hash-link" href="#загрузка-файлов-в-кеш" title="Direct link to heading">​</a></h3><p>Если в приложении есть работа с какими-то файлами, то имеет смысл загрузить их в кэш приложения, чтобы обеспечить к ним более быстрый доступ и, тем самым, ускорить работу приложения.   </p><p>Разберем кэширование на примере работы с картинками - юзер выбирает картинку с устройства, прикрепляет ее к сообщению - картинка из памяти устройства сохраняется в кэш, в сообщении сохраняется путь до этой картинки. Когда он просмотрит это сообщение, например, после повторного открытия приложения - картинка уже будет загружаться из кэша, что значительно ускорит процесс ее загрузки.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="на-android">на Android<a class="hash-link" href="#на-android" title="Direct link to heading">​</a></h4><p>Для начала - у нас есть кнопка, нажимая на которую мы запускаем <a href="https://developer.android.com/guide/components/intents-filters#ExampleSend" target="_blank" rel="noopener noreferrer">неявный Intent</a> <code>ACTION_PICK</code>.</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">binding.attachImgButton.setOnClickListener {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val intent = Intent(Intent.ACTION_PICK, MediaStore.Images.Media.INTERNAL_CONTENT_URI)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    startActivityForResult(intent, PICK_IMAGE_REQUEST_CODE)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>И обрабатываем результат, который вернула нам эта активити:</p><div class="language-kotlin codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-kotlin codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">override fun onActivityResult(requestCode: Int, resultCode: Int, returnIntent: Intent?) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (resultCode != Activity.RESULT_OK) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    returnIntent?.data?.also { returnUri -&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // получаем имя файла если есть, иначе создаем со своим</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        val fileName = returnUri.lastPathSegment ?: &quot;MyCachedImageFile&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // создаем файл в кэшах приложения</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        val cachedImageFile = File</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .createTempFile(fileName, &quot;.jpeg&quot;, requireContext().cacheDir)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // продолжаем логику, когда файл уже загружен в кэш</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        viewModel.onFilesLoaded(imageTitle = fileName, imagePath = cachedImageFile.path)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="на-ios">на iOS<a class="hash-link" href="#на-ios" title="Direct link to heading">​</a></h4><p>По нажатию кнопки запускаем <a href="https://developer.apple.com/documentation/uikit/uiimagepickercontroller" target="_blank" rel="noopener noreferrer">UIImagePickerController</a>, который предоставляет системный интерфейс для выбора картинок из галереи, фото с камеры, записи видео, и т.д.</p><div class="language-swift codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-swift codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @IBAction private func onAttachFilesButtonPressed(_: Any) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        let imagePicker = UIImagePickerController()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        imagePicker.delegate = self</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // указываем, откуда хотим получать картинку - photoLibrary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if UIImagePickerController.isSourceTypeAvailable(.photoLibrary) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imagePicker.sourceType = .photoLibrary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            self.present(imagePicker, animated: true)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-swift codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-swift codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    func imagePickerController(_: UIImagePickerController, didFinishPickingMediaWithInfo info: [UIImagePickerController.InfoKey: Any]) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        guard let selectedImage = info[.originalImage] as? UIImage,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              let imageUrl = info[.imageURL] as? URL else { return }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // получаем путь до директории кэшэй</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        guard let cacheURL = FileManager.default.urls(for: .cachesDirectory, in: .userDomainMask).first else { return }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // получаем путь, куда будет сохранена наша картинка </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        let imageCacheURL: URL = cacheURL.appendingPathComponent(imageUrl.lastPathComponent)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // пробуем сохранить картинку в кэш</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        do {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            try data.write(to: imageCacheURL)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } catch let e {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            print(&quot;Error saving data in cache: \(e)&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // продолжаем логику, когда файл уже загружен в кэш</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        issuesViewModel.onFilesLoaded(imagePath: imageCacheURL.path, imageTitle: imageUrl.lastPathComponent)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dismiss(animated: true, completion: nil)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/icerockdev/kmm.icerock.dev/tree/docusaurus/learning/libraries/ktor/ktor-client.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/learning/libraries/kotlinx/serialization"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">serialization</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/learning/libraries/moko"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">moko</div></a></nav><br></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#особенности-инициализации" class="table-of-contents__link toc-highlight">Особенности инициализации</a></li><li><a href="#получение-httpresponse" class="table-of-contents__link toc-highlight">Получение HttpResponse</a></li><li><a href="#добавление-логики-в-обработку-каждого-запросаответа" class="table-of-contents__link toc-highlight">Добавление логики в обработку каждого запроса/ответа</a></li><li><a href="#отправка-файлов" class="table-of-contents__link toc-highlight">Отправка файлов</a><ul><li><a href="#multipartform-data" class="table-of-contents__link toc-highlight">multipart/form-data</a></li><li><a href="#передача-файла-как-bytearray" class="table-of-contents__link toc-highlight">Передача файла как ByteArray</a></li><li><a href="#передача-файла-как-input" class="table-of-contents__link toc-highlight">Передача файла как Input</a></li><li><a href="#передача-файла-как-input-в-common-коде" class="table-of-contents__link toc-highlight">Передача файла как Input в common коде</a></li><li><a href="#submitformwithbinarydata" class="table-of-contents__link toc-highlight">submitFormWithBinaryData</a></li><li><a href="#multipartformdatacontent" class="table-of-contents__link toc-highlight">MultiPartFormDataContent</a></li><li><a href="#applicationoctet-stream" class="table-of-contents__link toc-highlight">application/octet-stream</a></li></ul></li><li><a href="#загрузка-файлов" class="table-of-contents__link toc-highlight">Загрузка файлов</a><ul><li><a href="#загрузка-файлов-в-кеш" class="table-of-contents__link toc-highlight">Загрузка файлов в кеш</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">IceRock Development</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://icerock.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Site</a></li><li class="footer__item"><a href="https://github.com/icerockdev" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://www.linkedin.com/company/icerockdevelopment" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn</a></li><li class="footer__item"><a href="https://www.facebook.com/icerockdevelopment" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://vk.com/icerockdev" target="_blank" rel="noopener noreferrer" class="footer__link-item">VK</a></li><li class="footer__item"><a href="https://www.instagram.com/icerockdevelopment" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC-Vhmm09W_IWKHhSg80d68w" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube</a></li><li class="footer__item"><a href="https://twitter.com/icerockdev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter @icerockdev<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/kotlinmpp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram @kotlinmpp<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/kotlinmppchats" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram @kotlinmppchats<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kotlinlang.org/community" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kotlin Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://kotlinlang.org/lp/mobile" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kotlin Multiplatform Mobile<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://libs.kmp.icerock.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kotlin Multiplatform Libs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://codelabs.kmp.icerock.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kotlin Multiplatform Codelabs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://moko.icerock.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">MOKO<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kotlinlang.org/docs/reference/native-overview.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kotlin/Native Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kotlinlang.org/docs/reference/multiplatform.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kotlin Multiplatform Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 IceRock Development. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2fb500ba.js"></script>
<script src="/assets/js/main.3aac4c1b.js"></script>
</body>
</html>